{
  "active": false,
  "connections": {
    "Transcribir Audio": {
      "main": [
        [
          {
            "node": "Set Mensaje",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Agente de IA": {
      "main": [
        [
          {
            "node": "Enviar Mensaje",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Switch": {
      "main": [
        [
          {
            "node": "Descargar Audio",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Set Texto",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Descargar Imagen",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Explicar Imagen": {
      "main": [
        [
          {
            "node": "Set Mensaje",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Telegram Trigger": {
      "main": [
        [
          {
            "node": "Switch",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code": {
      "main": [
        [
          {
            "node": "Explicar Imagen",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Descargar Imagen": {
      "main": [
        [
          {
            "node": "Code",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Descargar Audio": {
      "main": [
        [
          {
            "node": "Transcribir Audio",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Descargar audio Elevenlabs": {
      "main": [
        [
          {
            "node": "Enviar Audio",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Memoria": {
      "ai_memory": [
        [
          {
            "node": "Agente de IA",
            "type": "ai_memory",
            "index": 0
          }
        ]
      ]
    },
    "SerpAPI": {
      "ai_tool": [
        [
          {
            "node": "Agente de IA",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Agente Gmail": {
      "ai_tool": [
        [
          {
            "node": "Agente de IA",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Agente Calendar": {
      "ai_tool": [
        [
          {
            "node": "Agente de IA",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Agente Base Datos": {
      "ai_tool": [
        [
          {
            "node": "Agente de IA",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Set Mensaje": {
      "main": [
        [
          {
            "node": "Agente de IA",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Basic LLM Chain": {
      "main": [
        [
          {
            "node": "Descargar audio Elevenlabs",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Chat GPT #3": {
      "ai_languageModel": [
        [
          {
            "node": "Basic LLM Chain",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Chat GPT #2": {
      "ai_languageModel": [
        [
          {
            "node": "Agente de IA",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Chat GPT #1": {
      "ai_languageModel": [
        [
          {
            "node": "Explicar Imagen",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Pensamiento": {
      "ai_tool": [
        [
          {
            "node": "Agente de IA",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Set Texto": {
      "main": [
        [
          {
            "node": "Set Mensaje",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "createdAt": "2025-11-14T07:57:20.424Z",
  "id": "RjvnFu70dUPvQ3JK",
  "isArchived": false,
  "meta": null,
  "name": "Agente de Voz | Telegram",
  "nodes": [
    {
      "parameters": {
        "resource": "audio",
        "operation": "transcribe",
        "options": {}
      },
      "id": "d8ef7a93-c95d-4a7f-b309-75b8b9b16fb5",
      "name": "Transcribir Audio",
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "position": [
        -1296,
        224
      ],
      "typeVersion": 1.5,
      "credentials": {
        "openAiApi": {
          "id": "aKfvNfQbjB1WCvlS",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "={{ $json.mensaje }}",
        "options": {
          "systemMessage": "=# **Rol**\n\nEres Eva, una asesora de atenci√≥n al cliente en **AmorCanino**, un criadero especializado en criar y vender perros de raza con amor, cuidado y dedicaci√≥n. Con m√°s de 20 a√±os de experiencia en el sector, destacas por tu habilidad para entender las necesidades de las familias y personas interesadas en comprar un compa√±ero peludo, ayud√°ndolos a elegir la raza y el cachorro ideal para ellos.\n\n# **Tareas**\n\n1. **Venta de cachorro:** Tu tarea principal es conseguir la venta de un cachorro, debes perseguir este objetivo por encima de todo\n2. **Responder preguntas**: Tu tarea secundaria es responder dudas sobre especificaciones de raza, temperamento, cuidados, garant√≠as, precios, etc‚Ä¶\n\n# **Contexto**\n\n**AmorCanino** es un criadero reconocido por su trato √©tico y personalizado hacia los perros y los clientes, ofreciendo cachorros de raza criados con est√°ndares de calidad, cuidados veterinarios completos y un enfoque en encontrar el hogar perfecto para cada cachorro.\n\n# Proceso de Compra\n\n## 1. Averiguar Raza de Perro Ideal\n\n**Primero,** tienes que preguntarle al cliente si tiene alguna raza de perro en mente o si est√° buscando recomendaciones:\n\nSi **SI** tiene claro la raza de perro que quiere, no le hagas ninguna pregunta, sigue con el proceso de compra.\n\nSi **NO** tiene claro la raza de perro que quiere, tu trabajo es ayudarle a encontrar su raza de perro ideal, para ello, tienes que distinguir si:\n\n**El cliente NO te da datos sobre lo que busca, tendr√°s que:**\n\n- Hacerle las preguntas del apartado de ‚ÄúAsesoramiento‚Äù.\n- Activar la herramienta ‚ÄúBase de Datos‚Äù y ofrecerle razas de perros que cumplan con sus gustos.\n\n**El cliente SI te da datos sobre lo que busca o te da cualquier informaci√≥n, tendr√°s que:**\n\n- Activar la herramienta ‚ÄúBase de Datos‚Äù y ofrecerle razas de perros que cumplan con sus gustos.\n\n## 2. Averiguar Sexo y Color de Perro Ideal\n\n**Segundo,** despu√©s de que sepas la raza de perro que quiere el cliente, env√≠ale un simple mensaje pregunt√°ndole qu√© sexo y color de perro quiere.\n\n## 3. Enviar Fotos\n\n**Tercero,** despu√©s de que el cliente te diga que raza quiere y que sexo o color. [raza, sexo, color], tienes que:\n\n- Activar **SIEMPRE** la herramienta ‚Äúfotos‚Äù\n- Si recibies un ‚Äúresponse‚Äù de la herramienta ‚Äúfotos‚Äù, ten en cuenta el mensaje para incluirlo en tu respuesta\n- Si recibies un ‚Äúresponse‚Äù de la herramienta ‚Äúfotos‚Äù vac√≠o, significa que ahora mismo no tenemos disponible la raza que el cliente busca\n\n### **Notas Identificar M√©todo de Recogida**\n\n- **NUNCA** preguntes al cliente si quiere ver fotos de nuestros cachorros, toma la iniciativa y activa la herramienta ‚Äúfotos‚Äù cuando sepas la raza, sexo y color\n\n## 4. Identificar M√©todo de Recogida\n\n**Cuarto,** despu√©s de enviarle fotos al cliente de su raza ideal, expl√≠cale nuestros 2 m√©todos de recogida, que son:\n\n- **Asistir a nuestras instalaciones.**\n- **Env√≠o** del cachorro en **transporte especializado y autorizado** a su casa o a un punto de recogida, seg√∫n disponibilidad en su zona.\n\n### **Notas Identificar M√©todo de Recogida**\n\n- **NO** repitas los datos del cliente\n\n## 5. Recoger Datos del Cliente\n\n**Quinto,** despu√©s de que sepas que el m√©todo de recogida del cliente, env√≠ale un simple mensaje pregunt√°ndole los ‚ÄúDatos del Cliente‚Äù (Su nombre, tel√©fono y correo electr√≥nico).\n\n## 6. Enviar Horario\n\n**Sexto,** despu√©s de que sepas los datos del cliente, env√≠ale un simple mensaje dici√©ndole nuestro horario y pregunt√°ndole la hora a la que le gustar√≠a venir a visitar nuestras instalaciones.\n\n### Notas Horario\n\n- **NO** repitas los datos del cliente\n\n## **7. Hacer Resumen**\n\n**Septimo,** despu√©s de que sepas los datos del Cliente (Nombre, Tel√©fono y Correo Electr√≥nico), los datos de Visita (Fecha y Hora) y los datos de Perro (Raza, Sexo, Color), **env√≠ale el mensaje del apartado de ‚ÄúResumen‚Äù.**\n\n## 8. Agendar Visita\n\n**Octavo,** despu√©s de enviarle al cliente un ‚ÄúResumen‚Äù de la conversaci√≥n y que te diga que est√° bien, tienes que:\n\n1. **Activar la herramienta ‚Äúvisitas‚Äù**\n2. Enviarle al cliente el mensaje del apartado de **‚ÄúVisita Confirmada‚Äù**.\n\n### Notas Visita\n\n- Es **OBLIGATORIO** hacer estas 2 acciones **JUNTAS**\n\n# Mensaje de Bienvenida\n\n**Si el cliente es ‚ÄúNuevo‚Äù, env√≠ale SIEMPRE un mensaje diciendo tu nombre y pregunt√°ndole el suyo, env√≠ale textualmente el siguiente mensaje:**\n‚Äù¬°Hola, soy Eva! Encantada, c√≥mo te llamas? üòä [respuesta a la pregunta del cliente]‚Äù\n\n**Si el cliente es ‚ÄúViejo‚Äù y te saluda, env√≠ale SIEMPRE un mensaje sin decir tu nombre ni  pregunt√°ndole el suyo, como este:**\n\n¬°Hola! üòä [respuesta a la pregunta]\n\n# **Asesoramiento**\n\n**Si el cliente NO te da datos sobre lo que busca, tendr√°s que preguntar:**\n\n- ‚Äú¬øTienes alguna preferencia en cuanto al tama√±o?‚Äù\n- ‚Äú¬øTienes alguna preferencia en cuanto al car√°cter?‚Äù\n- ‚Äú¬øTienes ni√±os u otras mascotas en casa?‚Äù\n- ‚Äú¬øQu√© tan activa es tu rutina diaria?‚Äù\n\nEstas preguntas me ayudar√°n a entender mejor tus necesidades y hacerte algunas recomendaciones. üêæ\n\nTambi√©n puedes echarle un ojo a nuestra web, donde encontrar√°s las razas que criamos y sus caracter√≠sticas. üê∂‚ú®\n\n## Precios\n\n**SIEMPRE que le env√≠es a un cliente el precio de un perro, escribe TEXTUALMENTE (la parte de** [PRECIO] rellenarla con el precio de la raza USANDO LA HERRAMIENTA ‚ÄúBase de Datos‚Äù  **) el siguiente mensaje en este mismo formato y estructura, asegurate que cuando mandes este mensaje aparezca el precio de la raza que te solicita:**\n\nüí∂ Precio: [PRECIO] ‚Ç¨\n\nNuestros cachorros los entregamos a partir de los 2 meses, con:\n\nüê∂ 3 vacunas\nüíä 2 desparasitaciones\nüìç Microchip colocado\nüìò Cartilla sanitaria\nüßæ Condiciones de garant√≠a por escrito\nüõ°Ô∏è Garant√≠a: 15 d√≠as para parvo y moquillo + 1 a√±o para displasia de cadera\n\n# Disponibilidad\n\n**SIEMPRE que el cliente pregunte por la disponibilidad de una raza, activa la herramienta ‚Äú**Base de Datos**‚Äù:**\n\n**Si su raza tiene la etiqueta¬†‚ÄùSI TENEMOS ESTA RAZA‚Äù, usa la herramienta ‚Äúfotos‚Äù y escribe TEXTUALMENTE la parte de** [PRECIO] rellenarla con el precio de la raza USANDO LA HERRAMIENTA ‚ÄúBase de Datos‚Äù   **) el siguiente mensaje en este mismo formato y estructura, asegurate que cuando mandes este mensaje aparezca el precio de la raza que te solicita:**\n\n¬°S√≠! üéâ Tenemos [RAZA QUE SOLICITA] disponibles üêæ\n\nüí∂ Precio: [PRECIO] ‚Ç¨\n\nNuestros cachorros los entregamos a partir de los 2 meses, con:\n\nüê∂ 3 vacunas\nüíä 2 desparasitaciones\nüìç Microchip colocado\nüìò Cartilla sanitaria\nüßæ Condiciones de garant√≠a por escrito\nüõ°Ô∏è Garant√≠a: 15 d√≠as para parvo y moquillo + 1 a√±o para displasia de cadera\n\n**Si su raza SI tiene la etiqueta¬†‚ÄùNO QUEDAN ACTUALMENTE‚Äù, escribe TEXTUALMENTE el siguiente mensaje en este mismo formato y estructura:**\n\nAhora mismo no tenemos [raza]. Si quieres puedo abrirte una ficha de cliente para avisarte en cuanto tengamos disponibilidad. üìãüîî ¬°Ser√°s de los primeros/as en enterarte!\n\nPara ello, necesitar√≠a estos datos:\n\nüë§ Nombre y apellidos\n\nüÜî DNI\n\nüè° Direcci√≥n completa (con CP, poblaci√≥n y provincia)\n\nüìß Correo electr√≥nico\n\nüêï‚Äçü¶∫ ¬øBuscas macho o hembra?\n\nüé® ¬øAlg√∫n color en especial? (si esta raza tiene m√°s de uno)\n\nPuedes copiar, rellenar y reenviarme todo por aqu√≠ üòä.\n\n# Datos del Cliente\n\n**Antes de agendar una visita, pregunta los siguientes datos al cliente, en este mismo formato y estructura:**\n\n- Nombre\n- Correo Electr√≥nico\n- N√∫mero de Tel√©fono\n\nCon estos datos podremos agendar tu visita! üêæ‚ú®\n\n# Horario\n\n**SIEMPRE que un cliente pregunta por el horario o tienes que d√°rselo, escribe textualmente el siguiente mensaje:**\n\nNuestro horario de visita es:\n\n- De Lunes a Viernes: De 9:00 a 13:00 y De 15:00 a 19:00\n- S√°bado: De 10:00 a 13:00\n\nEs imprescindible venir con cita previa, as√≠ que dime. ¬øA qu√© hora te gustar√≠a venir a visitarnos? üïîüê∂\n\nSi un cliente quiere agendar una visita estos d√≠as, dile que elija otro d√≠a\n\n# Resumen\n\n**SIEMPRE que tengas que enviar el texto de resumen, escribe textualmente el siguiente mensaje:**\n\n¬°Genial! üê∂‚ú®\n\nEntonces, est√°s interesado en venir a ver a nuestros [Raza] y te gustar√≠a venir el [Fecha].\n\nQueremos asegurarnos de que todo est√© correcto. ¬øTe va bien esta fecha o prefieres otra? ¬°Cu√©ntanos y agendamos tu visita! üêæüíï\n\n# **M√©todos de pago:**\n\n**SIEMPRE que un cliente te pregunte por nuestros m√©todos de pagos, escribe textualmente el siguiente mensaje:**\n\nEstas son nuestras opciones de pago disponibles:\n\n1. **Transferencia Bancaria:** Puedes realizar una transferencia a nuestra cuenta bancaria. Te proporcionaremos los detalles de la cuenta una vez que confirmes la compra.\n2. **Tarjeta de Cr√©dito o D√©bito**: Aceptamos pagos con tarjeta, ya sea en persona en nuestras instalaciones o a trav√©s de un enlace seguro que te enviaremos.\n3. **Efectivo**: Si decides recoger el cachorro en nuestras instalaciones, puedes pagar en efectivo al momento de la recogida. En caso de que el importe del cachorro sea mayor que 1.000‚Ç¨, se podr√°s completar el pago con cualquiera de los m√©todos anteriores.\n\nUna vez que elijas el m√©todo de pago que prefieras, te proporcionaremos toda la informaci√≥n necesaria para completar la transacci√≥n. ¬øHay algo m√°s en lo que pueda ayudarte? üêæüí∞\n\n# **Transferir Mensajes**\n\n**SIEMPRE que un cliente quiera hablar con una persona (con mensaje o por llamada), escribe textualmente el siguiente mensaje:**\n\nSi prefieres hablar con un asesor, puedes llamar a este mismo n√∫mero. Nuestro horario de atenci√≥n telef√≥nica es: Lunes a Viernes de 9:00 a 13:00 y de 15h-19h. Los s√°bados de 10h-13h. ¬øHay algo m√°s en lo que pueda ayudarte por ahora? üòäüêæ\n\n# Ejemplo De Conversaci√≥n\n\n- **Cliente:** ‚ÄúQuiero un cockapoo‚Äù\n- **Eva**: ‚Äú¬°Excelente elecci√≥n! Los Cockapoos son perros sociables, cari√±osos e inteligentes. Dime, ¬øqu√© sexo y color de Cockapoo te gustar√≠a? üêæ‚Äù\n- **Cliente:** ‚Äúmacho, marr√≥n‚Äù\n- **Eva: ‚Äú**¬°Genial! üê∂‚ú® Ahora, ¬øte gustar√≠a ver fotos de nuestros Cockapoos? üêæüì∑‚Äù\n\n## Input\n\nEnv√≠a un correo electr√≥nico a Pau Berenguer pregunt√°ndole c√≥mo le va el d√≠a.\n\n## Acciones\n\n1. Llamar a la herramienta de ‚Äúagente_base_datos‚Äù para obtener al cliente.\n2. Llamar a la herramienta de  ‚Äúagente_gmail‚Äù para enviar el correo electr√≥nico.\n3. Llamar a la herramienta ‚Äúpensamiento‚Äù para comprobar que todas las tareas han sido completadas.\n\n# NO se Adopta\n\nEn **AmorCanino** **NO** ofrecemos el servicio de adopci√≥n\n\n# Formato de Respuesta\n\n- *NUNCA respondas utilizando negrita o utilizando el s√≠mbolo ***\n\n# **Notas**\n\n1. **Cordialidad y profesionalismo**: Mantente siempre cordial y profesional, transmitiendo confianza y pasi√≥n por los perros.\n2. **Proactividad:** Debes de ser proactiva y comercial para conseguir la venta del cachorro como objetivo principal\n3. **Respuestas:** **NUNCA** termines la conversaci√≥n, responde **SIEMPRE** de forma abierta para continuar la conversaci√≥n para conseguir vender el cachorro\n4. **Humano:** Env√≠a en cada mensaje emoticonos que tengan que ver con perros para hacer la conversaci√≥n m√°s amigable.\n5. **Proceso de compra:** Aseg√∫rate de seguir los pasos del proceso de compra en orden | Nunca hagas sentir al cliente que est√° siendo dirigido por un paso a paso, NUNCA digas cosas como ‚Äúcomo siguiente paso‚Ä¶‚Äù o ‚Äúsi est√°s listo para avanzar en la compra‚Äù\n6. **Importante: NO** proporcionamos historial m√©dico de ning√∫n cachorro | **NO** ofrecemos garant√≠as de salud | **NO** hacemos pruebas gen√©ticas | **NO** ofrecemos asesoramiento postventa.\n\n# Uso de Herramientas\n\n\n# Herramientas\n\npensamiento: Usa esta herramienta para pensar profundamente o si te quedas atascado.\n\nagente_gmail: Usa esta herramienta para realizar acciones en el correo electr√≥nico.\n\nagente_calendar: Usa esta herramienta para realizar acciones en el calendario (Cuando el usuario te pide que agendes reuniones con personas)\n\nagente_base_datos: Usa esta herramienta para obtener, actualizar o a√±adir contactos.\n\nSerpAPI: Usa esta herramienta para buscar informaci√≥n en internet.\n\n## Fecha actual: ‚Äú`{{ $now }}`\""
        }
      },
      "id": "0c913894-baa4-4616-a611-fd12afca7346",
      "name": "Agente de IA",
      "type": "@n8n/n8n-nodes-langchain.agent",
      "position": [
        -624,
        512
      ],
      "typeVersion": 1.6
    },
    {
      "parameters": {
        "content": "",
        "height": 220,
        "width": 400,
        "color": 7
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -704,
        464
      ],
      "typeVersion": 1,
      "id": "acf50300-2c57-4ff8-b934-cdf96c27777c",
      "name": "Sticky Note7"
    },
    {
      "parameters": {
        "content": "",
        "height": 220,
        "width": 720
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -1760,
        192
      ],
      "typeVersion": 1,
      "id": "116fb54c-7a32-42ef-a8cb-06ef72c08770",
      "name": "Sticky Note10",
      "disabled": true
    },
    {
      "parameters": {
        "mode": "expression",
        "numberOutputs": 3,
        "output": "={{ \n  // 0 ‚ûú Audio (voice + audio)\n  ($json.message.voice || $json.message.audio) ? 0\n  // 1 ‚ûú Texto\n  : $json.message.text                        ? 1          \n  // 2 ‚ûú Imagen\n  : $json.message.photo                       ? 2          \n  // -1 ‚ûú Else (v√≠deo, documento, sticker‚Ä¶)\n  : -1\n}}\n"
      },
      "id": "b206a52a-2b89-4216-b047-d25af5c97548",
      "name": "Switch",
      "type": "n8n-nodes-base.switch",
      "position": [
        -1984,
        512
      ],
      "typeVersion": 3.2
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=# Contexto\n\nRecibes como input  una imagen enviada por el usuario. \n\n# Tarea\n\nDescribe la imagen y transcribe cualquier texto visible.\n\n# Especificaciones\n\n Incluye tantos detalles como sea posible.",
        "messages": {
          "messageValues": [
            {
              "type": "HumanMessagePromptTemplate",
              "messageType": "imageBinary"
            }
          ]
        }
      },
      "id": "aa18cd3c-b1cd-4f91-8d84-1fdbb652774f",
      "name": "Explicar Imagen",
      "type": "@n8n/n8n-nodes-langchain.chainLlm",
      "position": [
        -1344,
        784
      ],
      "typeVersion": 1.4
    },
    {
      "parameters": {
        "updates": [
          "message"
        ],
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegramTrigger",
      "typeVersion": 1.2,
      "position": [
        -2256,
        512
      ],
      "id": "021c422e-1aa0-4364-8b18-f60644d5edf2",
      "name": "Telegram Trigger",
      "webhookId": "d5f1c18f-b21f-40c9-bb1e-16ea4bc38407",
      "credentials": {
        "telegramApi": {
          "id": "cljhbY7TT13yiHcw",
          "name": "Telegram BurnhamBot"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// Detecta la extensi√≥n y aplica el mime correcto\nconst map = { jpg: 'image/jpeg', jpeg: 'image/jpeg',\n              png: 'image/png',  webp: 'image/webp',\n              gif: 'image/gif' };\n\nfor (const item of $input.all()) {\n  const ext = (item.binary.data.fileExtension ||\n               item.binary.data.fileName.split('.').pop() || '').toLowerCase();\n  item.binary.data.mimeType = map[ext] || 'image/jpeg';\n}\n\nreturn $input.all();\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -1520,
        784
      ],
      "id": "32307449-1e81-4e5d-b2fe-c5d67f44ab1b",
      "name": "Code"
    },
    {
      "parameters": {
        "resource": "file",
        "fileId": "={{ $json.message.photo[0].file_id }}",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        -1696,
        784
      ],
      "id": "d0688d55-5997-486b-b205-5d1d10a63d14",
      "name": "Descargar Imagen",
      "webhookId": "14ff995a-f5c1-47f0-b40b-6dd08a8a1230",
      "credentials": {
        "telegramApi": {
          "id": "cljhbY7TT13yiHcw",
          "name": "Telegram BurnhamBot"
        }
      }
    },
    {
      "parameters": {
        "resource": "file",
        "fileId": "={{ $json.message.voice.file_id }}",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        -1616,
        224
      ],
      "id": "e34d3581-6987-4ca8-ae10-bdf70253a9e7",
      "name": "Descargar Audio",
      "webhookId": "14ff995a-f5c1-47f0-b40b-6dd08a8a1230",
      "credentials": {
        "telegramApi": {
          "id": "cljhbY7TT13yiHcw",
          "name": "Telegram BurnhamBot"
        }
      }
    },
    {
      "parameters": {
        "options": {}
      },
      "id": "fc43baa6-b6ec-4c64-95a7-da5747036980",
      "name": "SerpAPI",
      "type": "@n8n/n8n-nodes-langchain.toolSerpApi",
      "typeVersion": 1,
      "position": [
        -704,
        784
      ]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.elevenlabs.io/v1/text-to-speech/BjEROETieA12i9gT25f7",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n    \"text\": \"{{ $json.text }}\"\n}",
        "options": {}
      },
      "id": "3fc87f89-3346-4322-8884-2a2db74ae498",
      "name": "Descargar audio Elevenlabs",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        288,
        224
      ]
    },
    {
      "parameters": {
        "content": "",
        "height": 220,
        "width": 220,
        "color": 4
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        224,
        192
      ],
      "id": "4fc95299-e932-440b-b928-a679587203b6",
      "name": "Sticky Note20"
    },
    {
      "parameters": {
        "content": "",
        "width": 520,
        "color": 6
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -976,
        752
      ],
      "typeVersion": 1,
      "id": "41b3fe2e-0f4d-4438-91ff-e9e1952e4937",
      "name": "Sticky Note22"
    },
    {
      "parameters": {
        "sessionIdType": "customKey",
        "sessionKey": "=hola",
        "tableName": "conversaciones",
        "contextWindowLength": 30
      },
      "type": "@n8n/n8n-nodes-langchain.memoryPostgresChat",
      "typeVersion": 1.3,
      "position": [
        -816,
        784
      ],
      "id": "a2cc1ef8-a920-4ed4-9f2b-b33245908e82",
      "name": "Memoria"
    },
    {
      "parameters": {
        "content": "",
        "width": 500,
        "color": 5
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        -400,
        752
      ],
      "id": "ddd27250-1d61-4e19-b20d-dc554b0a0719",
      "name": "Sticky Note21"
    },
    {
      "parameters": {
        "name": "agente_gmail",
        "description": "Utiliza esta herrmienta para acciones de Gmail",
        "workflowId": {
          "__rl": true,
          "value": "NOLMTAtN2UQ08A1E",
          "mode": "list",
          "cachedResultName": "Sub Agente Gmail"
        },
        "workflowInputs": {
          "mappingMode": "defineBelow",
          "value": {},
          "matchingColumns": [],
          "schema": [],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        }
      },
      "type": "@n8n/n8n-nodes-langchain.toolWorkflow",
      "typeVersion": 2,
      "position": [
        -368,
        784
      ],
      "id": "bcf771d8-7cd5-411f-993e-9e23efed6f59",
      "name": "Agente Gmail"
    },
    {
      "parameters": {
        "name": "agente_calendar",
        "description": "Utiliza esta herrmienta para acciones de Calendar",
        "workflowId": {
          "__rl": true,
          "value": "564NDyTrCZOD6ZW9",
          "mode": "list",
          "cachedResultName": "Sub Agente Calendar"
        },
        "workflowInputs": {
          "mappingMode": "defineBelow",
          "value": {},
          "matchingColumns": [],
          "schema": [],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        }
      },
      "type": "@n8n/n8n-nodes-langchain.toolWorkflow",
      "typeVersion": 2,
      "position": [
        -208,
        784
      ],
      "id": "fce4a91a-84e5-4209-a10f-6164b5550b61",
      "name": "Agente Calendar"
    },
    {
      "parameters": {
        "name": "agente_base_datos",
        "description": "Utiliza esta herrmienta para acciones de Base de Datos",
        "workflowId": {
          "__rl": true,
          "value": "x0D7Lgzc6vazD1ry",
          "mode": "list",
          "cachedResultName": "Sub Agente Base Datos"
        },
        "workflowInputs": {
          "mappingMode": "defineBelow",
          "value": {},
          "matchingColumns": [],
          "schema": [],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        }
      },
      "type": "@n8n/n8n-nodes-langchain.toolWorkflow",
      "typeVersion": 2,
      "position": [
        -48,
        784
      ],
      "id": "551074db-512c-4453-a891-49f2671d4658",
      "name": "Agente Base Datos"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "23b785c3-f38e-4706-80b7-51f333bba3bd",
              "name": "mensaje",
              "type": "string",
              "value": "={{ $json.text }}"
            }
          ]
        },
        "options": {}
      },
      "id": "32710f7d-f342-4f73-8dde-e14134f0b874",
      "name": "Set Mensaje",
      "type": "n8n-nodes-base.set",
      "position": [
        -928,
        512
      ],
      "typeVersion": 3.4
    },
    {
      "parameters": {
        "content": "",
        "height": 220,
        "width": 220,
        "color": 2
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        512,
        192
      ],
      "typeVersion": 1,
      "id": "fa414d61-b608-40d9-a233-5fabc4bbe624",
      "name": "Sticky Note3"
    },
    {
      "parameters": {
        "operation": "sendAudio",
        "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
        "binaryData": true,
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        560,
        224
      ],
      "id": "cbaf2f36-0500-42f5-a370-157da05d4066",
      "name": "Enviar Audio",
      "webhookId": "aa9d0a26-9794-4748-bb23-b6ce94ffa3dd",
      "credentials": {
        "telegramApi": {
          "id": "cljhbY7TT13yiHcw",
          "name": "Telegram BurnhamBot"
        }
      }
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "={{ $json.output }}",
        "messages": {
          "messageValues": [
            {
              "message": "=# Contexto\n\nVas a recibir como input un mensaje adaptado a una conversaci√≥n por texto y debes adaptarla a una conversaci√≥n por audio\n\n# Tarea\n\nTu trabajo consiste en transformar el input recibido en un formato plano.\n\n# Especificaciones\n\nElimina cualquier s√≠mbolo como #@/- etc.. solo quiero que que me devuelvas el texto plano.\n\n# Ejemplos:\n\n## Ejemplo de Entrada:\n\nNuestro horario de visita es:\\n\\n- De Lunes a Viernes: De 9:00 a 13:00 y De 15:00 a 19:00\\n- S√°bado: De 10:00 a 13:00\\n\\nEs imprescindible venir con cita previa, as√≠ que dime. ¬øA qu√© hora te gustar√≠a venir a visitarnos? üïîüê∂\n\n## Ejemplo de Salida:\n\nNuestro horario de visita es de Lunes a Viernes de 9 a 13 y de 15 a 19 y los s√°bados de 10 a 13. Es imprescindible venir con cita previa, as√≠ que dime. ¬øA qu√© hora te gustar√≠a venir a visitarnos?\n\n# Reglas\n\nElimina cualquier salto de linea (\\n), el output tiene que ser totalmente texto plano\n\n"
            }
          ]
        },
        "batching": {}
      },
      "type": "@n8n/n8n-nodes-langchain.chainLlm",
      "typeVersion": 1.7,
      "position": [
        -160,
        224
      ],
      "id": "8e119073-fb7e-4232-a9c4-7719e12623f5",
      "name": "Basic LLM Chain"
    },
    {
      "parameters": {
        "content": "",
        "height": 240,
        "width": 400,
        "color": 7
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -240,
        160
      ],
      "typeVersion": 1,
      "id": "67ac4d7f-7710-4f18-acd6-284f5b5724ab",
      "name": "Sticky Note8"
    },
    {
      "parameters": {
        "content": "",
        "width": 160,
        "color": 6
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        0,
        0
      ],
      "typeVersion": 1,
      "id": "905d3869-05d1-41fd-a0d3-c831f73a0b87",
      "name": "Sticky Note23"
    },
    {
      "parameters": {
        "content": "",
        "height": 220,
        "width": 220,
        "color": 2
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -240,
        464
      ],
      "typeVersion": 1,
      "id": "292b92ea-7e29-4944-a8b7-6ae169c48e31",
      "name": "Sticky Note5"
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
        "text": "={{ $json.output }}",
        "additionalFields": {
          "appendAttribution": false
        }
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        -176,
        512
      ],
      "id": "cc3aadc6-ce00-4017-9563-89199a2c0461",
      "name": "Enviar Mensaje",
      "webhookId": "aa9d0a26-9794-4748-bb23-b6ce94ffa3dd",
      "credentials": {
        "telegramApi": {
          "id": "cljhbY7TT13yiHcw",
          "name": "Telegram BurnhamBot"
        }
      }
    },
    {
      "parameters": {
        "content": "",
        "width": 160,
        "color": 6
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -1200,
        960
      ],
      "typeVersion": 1,
      "id": "d0f6c893-517f-448f-8584-cea52e49743b",
      "name": "Sticky Note24"
    },
    {
      "parameters": {
        "model": "gpt-4o",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.1,
      "position": [
        48,
        48
      ],
      "id": "ec77708a-40d2-4b00-b329-ac485204acb2",
      "name": "Chat GPT #3",
      "credentials": {
        "openAiApi": {
          "id": "aKfvNfQbjB1WCvlS",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "model": "gpt-4o",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.1,
      "position": [
        -944,
        784
      ],
      "id": "d8a58e86-e9a3-455b-a075-ccb4cb161b8c",
      "name": "Chat GPT #2",
      "credentials": {
        "openAiApi": {
          "id": "aKfvNfQbjB1WCvlS",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "model": "gpt-4o",
        "options": {}
      },
      "id": "8ccfb7ca-0779-40ee-8cc0-166f9f839dff",
      "name": "Chat GPT #1",
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "position": [
        -1168,
        1008
      ],
      "typeVersion": 1,
      "credentials": {
        "openAiApi": {
          "id": "aKfvNfQbjB1WCvlS",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "content": "",
        "height": 220,
        "width": 220,
        "color": 2
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -2320,
        464
      ],
      "typeVersion": 1,
      "id": "10ef097d-197e-4c07-a566-39a63fb68800",
      "name": "Sticky Note9"
    },
    {
      "parameters": {
        "content": "",
        "height": 220,
        "width": 220,
        "color": 4
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -2048,
        464
      ],
      "typeVersion": 1,
      "id": "04c276e5-5490-4a14-9d81-ccd74533cdf9",
      "name": "Sticky Note"
    },
    {
      "parameters": {
        "content": "",
        "height": 220,
        "width": 220,
        "color": 4
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -976,
        464
      ],
      "typeVersion": 1,
      "id": "5b40f666-4bcc-4892-b435-3f7cdf9bd5d1",
      "name": "Sticky Note1"
    },
    {
      "parameters": {
        "content": "",
        "height": 220,
        "width": 720
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -1760,
        464
      ],
      "typeVersion": 1,
      "id": "48b33068-3c2a-466d-93f5-b09dac1c3aeb",
      "name": "Sticky Note11",
      "disabled": true
    },
    {
      "parameters": {
        "content": "",
        "height": 220,
        "width": 720
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -1760,
        752
      ],
      "typeVersion": 1,
      "id": "a1936714-66db-4609-abc4-a1e9ca4c9bd2",
      "name": "Sticky Note12",
      "disabled": true
    },
    {
      "parameters": {
        "description": "=Use the tool to think about something. It will not obtain new information or change the database, but just append the thought to the log. Use it when complex reasoning or some cache memory is needed."
      },
      "type": "@n8n/n8n-nodes-langchain.toolThink",
      "typeVersion": 1,
      "position": [
        -576,
        784
      ],
      "id": "9d85dcb1-d699-4f75-8113-05c17e7b8d9c",
      "name": "Pensamiento"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "d4b9efeb-9a68-43e3-bc4c-cd207510bddf",
              "name": "text",
              "value": "={{ $json.message.text }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -1456,
        512
      ],
      "id": "bb0c3fed-23fd-4f04-890e-608ced3f8b3b",
      "name": "Set Texto"
    },
    {
      "parameters": {
        "content": "## ChatBot de Telegram que HABLA: Entiende Audio, Texto e Im√°genes\n# [Guide](https://www.skool.com/the-ai-blueprint/nuevo-video-crea-un-chatbot-de-telegram-que-habla-entiende-audio-texto-e-imagenes-plantilla-gratis)",
        "height": 144,
        "width": 464
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -1552,
        -112
      ],
      "typeVersion": 1,
      "id": "8dedcf82-2c72-4bfa-a420-48cfdf55dbc5",
      "name": "Sticky Note2"
    }
  ],
  "pinData": {},
  "settings": {
    "executionOrder": "v1"
  },
  "shared": [
    {
      "updatedAt": "2025-11-14T07:57:20.429Z",
      "createdAt": "2025-11-14T07:57:20.429Z",
      "role": "workflow:owner",
      "workflowId": "RjvnFu70dUPvQ3JK",
      "projectId": "epI1cymQzCzDlQMH"
    }
  ],
  "staticData": null,
  "tags": [
    {
      "updatedAt": "2025-11-17T19:03:46.445Z",
      "createdAt": "2025-11-12T04:49:35.964Z",
      "id": "FSFCRUJRQgBqMwY7",
      "name": "üü§ Pau Berenguer"
    }
  ],
  "triggerCount": 0,
  "updatedAt": "2025-11-17T19:03:51.000Z",
  "versionId": "f282bf34-8cfc-4f6f-961c-2f2250eb3883"
}